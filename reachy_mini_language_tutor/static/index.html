<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Reachy Language Partner â€“ Settings</title>
    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body>
    <div class="ambient"></div>
    <div id="loading" class="loading">
      <div class="spinner"></div>
      <p>Loadingâ€¦</p>
    </div>

    <div class="container">
      <header class="hero">
        <div class="pill">Headless control</div>
        <h1>Reachy Language Partner</h1>
        <p class="subtitle">Configure API keys, language profiles, and advanced settings.</p>
      </header>

      <!-- Getting Started Guide (Collapsible) -->
      <div id="getting-started-panel" class="panel panel-collapsible hidden">
        <button class="panel-header panel-toggle" id="getting-started-toggle" aria-expanded="true">
          <div class="panel-title">
            <h3>ðŸš€ Getting Started</h3>
          </div>
          <svg class="icon-chevron" width="20" height="20" viewBox="0 0 20 20">
            <path d="M5 7.5l5 5 5-5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>

        <div id="getting-started-content" class="panel-content">
          <div class="setting-group">
            <!-- Step 1 -->
            <div class="setting-section">
              <div class="section-header">
                <h4>Step 1: Enter Your API Key</h4>
                <p class="section-hint">Required for voice conversation with your language tutor</p>
              </div>
              <div class="info-callout" style="background: linear-gradient(135deg, rgba(78, 205, 196, 0.12), rgba(78, 205, 196, 0.08)); border: 1px solid rgba(78, 205, 196, 0.3);">
                <svg class="icon-info" width="20" height="20" viewBox="0 0 20 20" style="color: var(--info);">
                  <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2" fill="none" />
                  <text x="10" y="14" text-anchor="middle" font-size="12" font-weight="bold" fill="currentColor">i</text>
                </svg>
                <p>Your OpenAI API key starts with <code style="font-family: var(--font-mono); background: rgba(0,0,0,0.05); padding: 2px 6px; border-radius: 4px;">sk-</code>. Enter it in the API Configuration section below. <a href="https://platform.openai.com/api-keys" target="_blank" class="link-external">Get your key â†’</a></p>
              </div>
            </div>

            <div class="setting-divider"></div>

            <!-- Step 2 -->
            <div class="setting-section">
              <div class="section-header">
                <h4>Step 2: Choose Your Language Tutor</h4>
                <p class="section-hint">Select from French, Spanish, German, Italian, Portuguese, or general practice</p>
              </div>
              <p style="font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6;">
                Each tutor brings their native language and cultural expertise. Pick the language you'd like to practice in the "Language Profile" section below.
              </p>
            </div>

            <div class="setting-divider"></div>

            <!-- Step 3 -->
            <div class="setting-section">
              <div class="section-header">
                <h4>Step 3: Start Your Conversation</h4>
                <p class="section-hint">Once configured, your tutor is ready to chat!</p>
              </div>
              <p style="font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: var(--space-md);">
                Simply start speaking naturally. Your robot tutor will listen, respond with voice and expressive movements, and help you learn.
              </p>
              <div class="info-callout" style="background: linear-gradient(135deg, rgba(255, 181, 71, 0.12), rgba(255, 181, 71, 0.08)); border: 1px solid rgba(255, 181, 71, 0.3);">
                <svg class="icon-info" width="20" height="20" viewBox="0 0 20 20" style="color: var(--warning);">
                  <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2" fill="none" />
                  <text x="10" y="14" text-anchor="middle" font-size="12" font-weight="bold" fill="currentColor">ðŸ’¡</text>
                </svg>
                <div>
                  <p style="margin-bottom: var(--space-xs); font-weight: 600;">Conversation Tips:</p>
                  <ul style="margin: 0; padding-left: var(--space-lg); font-size: 0.85rem; line-height: 1.6;">
                    <li>Speak at a natural pace - your tutor is patient</li>
                    <li>Ask for grammar explanations when confused</li>
                    <li>Request cultural context to deepen understanding</li>
                    <li>Practice regularly for best results</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- API Configuration Panel -->
      <div id="api-panel" class="panel hidden">
        <div class="panel-header">
          <div class="panel-title">
            <h2>API Configuration</h2>
          </div>
        </div>

        <!-- OpenAI Key -->
        <div class="setting-group">
          <!-- Input Form (when key is missing) -->
          <div id="openai-input-form" class="setting-row hidden">
            <div class="setting-info">
              <label for="openai-key">
                OpenAI API Key
                <span class="badge badge-required">Required</span>
              </label>
              <p class="hint">Required for realtime conversation with language tutors</p>
            </div>
            <div class="setting-control">
              <div class="input-group">
                <input id="openai-key" type="password" placeholder="sk-..." autocomplete="off" />
                <button id="save-openai-btn" class="btn-primary">
                  <span class="btn-text">Save</span>
                </button>
              </div>
              <div id="openai-status" class="status-message"></div>
            </div>
          </div>

          <!-- Configured State (when key exists) -->
          <div id="openai-configured" class="setting-row setting-configured hidden">
            <div class="setting-info">
              <label>OpenAI API Key</label>
              <p class="hint">Key is configured and validated</p>
            </div>
            <div class="setting-control">
              <div class="status-badge status-success">
                <span class="badge-text">Connected</span>
              </div>
              <button id="change-openai-btn" class="btn-ghost">Change key</button>
            </div>
          </div>
        </div>

        <!-- SuperMemory Key (Optional) -->
        <div class="setting-group setting-optional">
          <div class="setting-divider"></div>

          <!-- Input Form (when key is missing) -->
          <div id="supermemory-input-form" class="setting-row hidden">
            <div class="setting-info">
              <label for="supermemory-key">
                SuperMemory API Key
                <span class="badge badge-optional">Optional</span>
              </label>
              <p class="hint">Enable persistent memory across sessions for personalized learning</p>
              <a href="https://supermemory.ai" target="_blank" class="link-external">
                Get your key â†’
              </a>
            </div>
            <div class="setting-control">
              <div class="input-group">
                <input id="supermemory-key" type="password" placeholder="sm-..." autocomplete="off" />
                <button id="save-supermemory-btn" class="btn-secondary">
                  <span class="btn-text">Save</span>
                </button>
              </div>
              <div id="supermemory-status" class="status-message"></div>
            </div>
          </div>

          <!-- Configured State (when key exists) -->
          <div id="supermemory-configured" class="setting-row setting-configured hidden">
            <div class="setting-info">
              <label>
                SuperMemory API Key
                <span class="badge badge-optional">Optional</span>
              </label>
              <p class="hint">Persistent memory is enabled for personalized learning</p>
            </div>
            <div class="setting-control">
              <div class="status-badge status-success">
                <span class="badge-text">Connected</span>
              </div>
              <button id="change-supermemory-btn" class="btn-ghost">Change key</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Personality Selection (Simplified) -->
      <div id="personality-panel" class="panel hidden">
        <div class="panel-header">
          <div class="panel-title">
            <h2>Language Profile</h2>
          </div>
          <span class="badge badge-live">Live</span>
        </div>

        <div class="setting-group">
          <div class="setting-row">
            <div class="setting-info">
              <label for="personality-select">Select Language Tutor</label>
              <p class="hint">Choose your conversation partner (French, Spanish, German, etc.)</p>
            </div>
            <div class="setting-control">
              <select id="personality-select" class="select-large"></select>
            </div>
          </div>

          <div class="setting-actions">
            <button id="apply-personality" class="btn-primary">
              <span class="btn-text">Apply Now</span>
            </button>
            <button id="persist-personality" class="btn-secondary">
              <span class="btn-text">Set as Default</span>
            </button>
            <div id="startup-info" class="info-badge">
              <span id="startup-label">Launch on start: Built-in default</span>
            </div>
          </div>

          <div id="personality-status" class="status-message"></div>
        </div>
      </div>

      <!-- Advanced Settings (Collapsible) -->
      <div id="advanced-panel" class="panel panel-collapsible hidden">
        <button class="panel-header panel-toggle" id="advanced-toggle" aria-expanded="false">
          <div class="panel-title">
            <h3>Advanced Settings</h3>
          </div>
          <svg class="icon-chevron" width="20" height="20" viewBox="0 0 20 20">
            <path d="M5 7.5l5 5 5-5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>

        <div id="advanced-content" class="panel-content panel-collapsed">
          <div class="setting-group">
            <!-- Idle Behavior Section -->
            <div class="setting-section">
              <div class="section-header">
                <h4>Idle Behavior</h4>
                <p class="section-hint">Control autonomous robot actions when idle (cost optimization)</p>
              </div>

              <!-- Enable Toggle -->
              <div class="setting-row">
                <div class="setting-info">
                  <label for="enable-idle-signals">Enable Idle Animations</label>
                  <p class="hint">Robot performs dances and looks around when no conversation is active</p>
                </div>
                <div class="setting-control">
                  <label class="toggle-switch">
                    <input id="enable-idle-signals" type="checkbox" checked aria-label="Enable idle animations" />
                    <span class="toggle-slider"></span>
                    <span class="toggle-label" data-on="Enabled" data-off="Disabled"></span>
                  </label>
                </div>
              </div>

              <!-- Timeout Slider -->
              <div class="setting-row" id="timeout-setting">
                <div class="setting-info">
                  <label for="idle-timeout-slider">Idle Timeout</label>
                  <p class="hint">Time before idle behavior triggers (Â±25% variance for natural behavior)</p>
                </div>
                <div class="setting-control setting-control-slider">
                  <input
                    id="idle-timeout-slider"
                    type="range"
                    min="30"
                    max="900"
                    value="300"
                    step="30"
                    aria-label="Idle timeout in seconds"
                  />
                  <div class="slider-display">
                    <span id="timeout-value" class="slider-value">5:00</span>
                    <span class="slider-unit">minutes</span>
                  </div>
                  <div class="slider-range">
                    <span class="range-min">30s</span>
                    <span class="range-max">15m</span>
                  </div>
                </div>
              </div>

              <!-- Cost Info -->
              <div class="info-callout info-callout-warning">
                <svg class="icon-info" width="20" height="20" viewBox="0 0 20 20">
                  <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2" fill="none" />
                  <text x="10" y="14" text-anchor="middle" font-size="12" font-weight="bold" fill="currentColor">i</text>
                </svg>
                <p>Disabling idle animations reduces API costs by 85-90%</p>
              </div>
            </div>

            <!-- Save Button -->
            <div class="setting-actions">
              <button id="save-advanced" class="btn-primary">
                <span class="btn-text">Save Settings</span>
              </button>
              <div id="advanced-status" class="status-message"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="/static/main.js"></script>
  </body>
</html>
